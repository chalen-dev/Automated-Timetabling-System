# Base image
FROM php:8.2-fpm

# Working directory
WORKDIR /var/www

# 1️⃣ Update apt sources
RUN apt-get update

# 2️⃣ Install basic utilities
RUN apt-get install -y --no-install-recommends git unzip curl zip

# 3️⃣ Install SQLite, GD dependencies, libzip, and build tools
RUN apt-get install -y --no-install-recommends \
    build-essential \
    libpng-dev \
    libjpeg-dev \
    libfreetype6-dev \
    libonig-dev \
    libxml2-dev \
    libsqlite3-dev \
    libzip-dev \
    sqlite3

# 4️⃣ Install Python + pip
RUN apt-get install -y --no-install-recommends python3 python3-pip

# 5️⃣ Install Node.js (v18 LTS from NodeSource)
RUN curl -fsSL https://deb.nodesource.com/setup_18.x | bash - && apt-get install -y nodejs

# 6️⃣ Configure and install PHP extensions
RUN docker-php-ext-configure gd --with-freetype --with-jpeg && \
    docker-php-ext-install pdo_sqlite mbstring exif pcntl bcmath gd zip
